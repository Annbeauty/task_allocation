<?xml version="1.0"?>
<launch>
  <!-- Start Gazebo with an empty world. -->
  <include file="$(find gazebo_ros)/launch/empty_world.launch">
    <arg name="use_sim_time" value="true"/>
    <arg name="debug"        value="false"/>
    <arg name="gui"          value="false"/>
	  <arg name="headless"     value="false"/>			
    <arg name="world_name"   value="$(find my_jackal_gazebo)/worlds/slow_world.world"/>
    <arg name="paused"       value="false"/>
  </include>
  
  <!-- Spawn the robots. -->
  <include file="$(find my_jackal_base)/launch/jackal_base.launch">
    <arg name="ns"            value="jackal0"/>
	  <arg name="use_move_base" value="true"/>
  </include>
  <include file="$(find my_jackal_base)/launch/jackal_base.launch">
    <arg name="ns"            value="jackal1"/>
    <arg name="x"             value="-1"/>
    <arg name="yaw"           value="3.14"/>
    <arg name="use_move_base" value="true"/>
  </include>-
  

  <!-- Launch waypoint following.
       tasks:  x,y,z,  x,y,z,w
       robots: x,y,z                 -->
  <node pkg="centralised_auction" type="centralised_auction_node" name="centralised_auction" output="screen">
    <rosparam param="tasks">[ 4, 4, 0,  0, 0, 0, 1,
                             -1, 2, 0,  0, 0, 0, 1, 
                              3, 4, 0,  0, 0, 0, 1,
                             -4, 2, 0,  0, 0, 0, 1,
                             -1,-4, 0,  0, 0, 0, 1,
                             -3,-4, 0,  0, 0, 0, 1,
                              ]
    </rosparam>
    <rosparam param="robots">[0, 0, 0, 
                              1, 0, 0]
                              
    </rosparam>      
  </node>
  
  <!-- Launch waypoint following. -->
  <node ns="jackal0" pkg="waypoint_follower" type="waypoint_follower_node" name="waypoint_follower" output="screen">
    <remap from="update_waypoints" to="tasks"/>
  </node>
  <node ns="jackal1" pkg="waypoint_follower" type="waypoint_follower_node" name="waypoint_follower" output="screen">
    <remap from="update_waypoints" to="tasks"/>
  </node>
  
  <!-- Display on RVIZ. -->
  <group if="true">
    <node name="rviz" pkg="rviz" type="rviz"
        args="-d $(find centralised_auction)/config/rviz3.rviz">
    </node>
  </group>  
  
</launch>
